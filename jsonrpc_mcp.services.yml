services:
  jsonrpc_mcp.tool_discovery:
    class: Drupal\jsonrpc_mcp\Service\McpToolDiscoveryService
    arguments: ['@jsonrpc.handler', '@current_user']

  jsonrpc_mcp.tool_normalizer:
    class: Drupal\jsonrpc_mcp\Normalizer\McpToolNormalizer

  jsonrpc_mcp.middleware.oauth_scope_validator:
    class: Drupal\jsonrpc_mcp\Middleware\OAuthScopeValidator
    arguments:
      - '@http_kernel.basic'
      - '@jsonrpc_mcp.tool_discovery'
    tags:
      - { name: http_middleware, priority: 200, responder: true }
